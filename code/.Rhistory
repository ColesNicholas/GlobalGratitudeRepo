library(dplyr)
library(tidyverse)
library(here)
library(openxlsx)
library(readr)
# specify directory
i_am("code/GlobalGratitude_LabSpecificData.Rmd")
data_main <- read_csv("C:/Users/avd002/Dropbox/PC/Documents/GitHub/GlobalGratitudeProject/data/GlobalGratitude_LabSpecificData.csv")
test <- data %>% filter(ResponseId == "R_49ne35L17ilpYDE")
library(dplyr)
test <- data %>% filter(ResponseId == "R_49ne35L17ilpYDE")
data <- read_csv("C:/Users/avd002/Dropbox/PC/Documents/GitHub/GlobalGratitudeProject/data/GlobalGratitude_LabSpecificData.csv")
test <- data %>% filter(ResponseId == "R_49ne35L17ilpYDE")
View(test)
data_USA_02b <- read.csv(file = here("data", "USA_002b_raw_harmonized.csv"))
data_USA_02b <- read.csv(file = here("data", "USA_002b_raw_harmonized.csv"))
data_USA_02b <- read.csv(file = here("data", "USA_02b_raw_harmonized.csv"))
data_USA_02b <- data_USA_02b %>%
rename("Duration (in seconds)" = `Duration..in.seconds.`) %>%
rename("control_events" = `control_list`)
View(data_USA_02b)
data_USA_02c <- read.csv(file = here("data", "USA_02c.csv"))
View(data)
data <- bind_rows(data_main, data_USA_02b)
data <- bind_rows(data_main, data_USA_02c)
data <- read_csv("C:/Users/avd002/Dropbox/PC/Documents/GitHub/GlobalGratitudeProject/data/GlobalGratitude_LabSpecificData.csv")
data <- data %>% select(Progress:`Duration (in seconds)`,ResponseId,consent:grat_god_letter, me_attention, meals_attention, attention_check:feedback, lab)
# Fetch the USA_02b (harmonized) survey data
data_USA_02b <- read.csv(file = here("data", "USA_02b_raw_harmonized.csv"))
data_USA_02b <- data_USA_02b %>%
rename("Duration (in seconds)" = `Duration..in.seconds.`) %>%
rename("control_events" = `control_list`)
data_USA_02b <- data_USA_02b %>% select(Progress:`Duration (in seconds)`,ResponseId,consent:grat_god_letter, me_attention, meals_attention, attention_check:feedback, lab)
data_USA_02b <- read.csv(file = here("data", "USA_02b_raw_harmonized.csv"))
data_USA_02b <- data_USA_02b %>%
rename("Duration (in seconds)" = `Duration..in.seconds.`) %>%
rename("control_events" = `control_list`)
data_USA_02b <- data_USA_02b %>% select(Progress:`Duration (in seconds)`,ResponseId,consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
# Fetch the USA_02c survey data
data_USA_02c <- read.csv(file = here("data", "USA_02c.csv"))
data_USA_02c <- data_USA_02c %>% select(Progress:`Duration (in seconds)`,ResponseId,consent:grat_god_letter, me_attention, meals_attention, attention_check:feedback, lab)
# Fetch the USA_02c survey data
data_USA_02c <- read.csv(file = here("data", "USA_02c.csv"))
data_USA_02c <- data_USA_02c %>% select(Progress:Duration..in.seconds.,ResponseId,consent:grat_god_letter, me_attention, meals_attention, attention_check:feedback, lab)
data <- bind_rows(data_main, data_USA_02b)
data_USA_02c <- data_USA_02c %>%
mutate(across(c(Progress), as.character)) %>%
select(Progress:Duration..in.seconds.,ResponseId,consent:grat_god_letter, me_attention, meals_attention, attention_check:feedback, lab)
data <- bind_rows(data_main, data_USA_02b)
data_USA_02c <- data_USA_02c %>%
mutate(across(c(Progress), as.character))
data <- bind_rows(data_main, data_USA_02c)
View(data_USA_02c)
data_USA_02c <- data_USA_02c %>%
mutate(across(c(Progress, consent), as.character)) %>%
select(Progress:Duration..in.seconds.,ResponseId,consent:grat_god_letter, me_attention, meals_attention, attention_check:feedback, lab)
# Read and combine the CSV files
data <- bind_rows(data_main, data_USA_02b)
data_USA_02c <- data_USA_02c %>%
mutate(across(c(Progress, consent), as.character)) %>%
select(Progress:Duration..in.seconds.,ResponseId,consent:grat_god_letter, me_attention, meals_attention, attention_check:feedback, lab)
data <- bind_rows(data_main, data_USA_02c)
data_USA_02c <- data_USA_02c %>%
mutate(across(c(Progress, consent, meals_attention), as.character)) %>%
select(Progress:Duration..in.seconds.,ResponseId,consent:grat_god_letter, me_attention, meals_attention, attention_check:feedback, lab)
data <- bind_rows(data_main, data_USA_02c)
mutate(across(c(Progress, consent, meals_attention, attention_check), as.character)) %>%
select(Progress:Duration..in.seconds.,ResponseId,consent:grat_god_letter, me_attention, meals_attention, attention_check:feedback, lab)
data <- bind_rows(data_main, data_USA_02c)
data_USA_02c <- read.csv(file = here("data", "USA_02c.csv"))
data_USA_02c <- data_USA_02c %>%
mutate(across(c(Progress, consent, meals_attention, attention_check), as.character)) %>%
select(Progress:Duration..in.seconds.,ResponseId,consent:grat_god_letter, me_attention, meals_attention, attention_check:feedback, lab)
data <- bind_rows(data_main, data_USA_02c)
mutate(across(c(Progress, consent, meals_attention, attention_check, intervention_check), as.character)) %>%
select(Progress:Duration..in.seconds.,ResponseId,consent:grat_god_letter, me_attention, meals_attention, attention_check:feedback, lab)
data <- bind_rows(data_main, data_USA_02c)
mutate(across(c(Progress, consent, meals_attention, attention_check, intervention_check), as.character)) %>%
select(Progress:Duration..in.seconds.,ResponseId,consent:grat_god_letter, me_attention, meals_attention, attention_check:feedback, lab)
data <- data %>%
mutate(across(c(Progress, consent, meals_attention, attention_check, intervention_check), as.character)) %>%
select(Progress:Duration..in.seconds., ResponseId, consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data_USA_02c <- read.csv(file = here("data", "USA_02c.csv"))
data_USA_02c <- data_USA_02c %>%
data <- data %>%
mutate(across(c(Progress, consent, meals_attention, attention_check, intervention_check), as.character)) %>%
select(Progress:`Duration (in seconds)`, ResponseId, consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data_USA_02c <- read.csv(file = here("data", "USA_02c.csv"))
data_USA_02c <- data_USA_02c %>%
mutate(across(c(Progress, consent, meals_attention, attention_check, intervention_check), as.character)) %>%
select(Progress:`Duration (in seconds)`, ResponseId, consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data_USA_02c <- data_USA_02c %>%
mutate(across(c(Progress, consent, meals_attention, attention_check, intervention_check), as.character)) %>%
select(Progress:Duration..in.seconds., ResponseId, consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data <- bind_rows(data_main, data_USA_02c)
data <- read_csv("C:/Users/avd002/Dropbox/PC/Documents/GitHub/GlobalGratitudeProject/data/GlobalGratitude_LabSpecificData.csv")
data <- data %>% select(Progress:`Duration (in seconds)`,ResponseId,consent:grat_god_letter, me_attention, meals_attention, attention_check:feedback, lab)
# Fetch the USA_02b (harmonized) survey data
data_USA_02b <- read.csv(file = here("data", "USA_02b_raw_harmonized.csv"))
data_USA_02b <- data_USA_02b %>%
rename("Duration (in seconds)" = `Duration..in.seconds.`) %>%
rename("control_events" = `control_list`)
data_USA_02b <- data_USA_02b %>% select(Progress:`Duration (in seconds)`,ResponseId,consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data_USA_02c <- read.csv(file = here("data", "USA_02c.csv"))
data_USA_02c <- data_USA_02c %>%
mutate(across(c(Progress, consent, meals_attention, attention_check, intervention_check), as.character)) %>%
select(Progress:Duration..in.seconds., ResponseId, consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data <- bind_rows(data_main, data_USA_02b)
data <- bind_rows(data_main, data_USA_02b)
data_USA_02b <- read.csv(file = here("data", "USA_02b_raw_harmonized.csv"))
data_USA_02b <- data_USA_02b %>%
rename("Duration (in seconds)" = `Duration..in.seconds.`) %>%
rename("control_events" = `control_list`) %>%
mutate(across(where(is.double), as.character))
data_USA_02b <- data_USA_02b %>% select(Progress:`Duration (in seconds)`,ResponseId,consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data_USA_02c <- read.csv(file = here("data", "USA_02c.csv"))
data_USA_02c <- data_USA_02c %>%
mutate(across(where(is.double), as.character)) %>%
select(Progress:Duration..in.seconds., ResponseId, consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data <- bind_rows(data_main, data_USA_02b)
data_USA_02b <- data_USA_02b %>%
rename("Duration (in seconds)" = `Duration..in.seconds.`) %>%
rename("control_events" = `control_list`) %>%
mutate(across(where(is.double), as.character)) %>%%>%
data_USA_02b <- data_USA_02b %>%
rename("Duration (in seconds)" = `Duration..in.seconds.`) %>%
rename("control_events" = `control_list`) %>%
mutate(across(where(is.double), as.character)) %>%
mutate(across('Duration (in seconds)', as.integer)) %>%
select(Progress:'Duration (in seconds)',ResponseId,consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data_USA_02b <- data_USA_02b %>%
rename("Duration (in seconds)" = `Duration..in.seconds.`) %>%
rename("control_events" = `control_list`) %>%
mutate(across(where(is.double), as.character)) %>%
mutate(across(`Duration (in seconds)`, as.integer)) %>%
select(Progress:`Duration (in seconds)`,ResponseId,consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data_USA_02b <- data_USA_02b %>% mutate(across(where(is.double), as.character)) %>%
mutate(across(`Duration (in seconds)`, as.integer)) %>%
select(Progress:`Duration (in seconds)`,ResponseId,consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data <- bind_rows(data_main, data_USA_02b)
data <- bind_rows(data_main, data_USA_02b)
is.integer(data_USA_02b$`Duration (in seconds)'')
data <- read_csv("C:/Users/avd002/Dropbox/PC/Documents/GitHub/GlobalGratitudeProject/data/GlobalGratitude_LabSpecificData.csv")
data <- data %>% select(Progress:`Duration (in seconds)`,ResponseId,consent:grat_god_letter, me_attention, meals_attention, attention_check:feedback, lab)
data <- read_csv("C:/Users/avd002/Dropbox/PC/Documents/GitHub/GlobalGratitudeProject/data/GlobalGratitude_LabSpecificData.csv")
data <- data %>% select(Progress:`Duration (in seconds)`,ResponseId,consent:grat_god_letter, me_attention, meals_attention, attention_check:feedback, lab)
data_USA_02b <- read.csv(file = here("data", "USA_02b_raw_harmonized.csv"))
data_USA_02b <- data_USA_02b %>%
rename("Duration (in seconds)" = `Duration..in.seconds.`) %>%
rename("control_events" = `control_list`)
data_USA_02b <- data_USA_02b %>%
select(Progress:`Duration (in seconds)`,ResponseId,consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data_USA_02c <- read.csv(file = here("data", "USA_02c.csv"))
data_USA_02c <- data_USA_02c %>%  select(Progress:Duration..in.seconds., ResponseId, consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data <- bind_rows(data_main, data_USA_02b)
data_USA_02b <- data_USA_02b %>%
mutate(across(where(is.double), as.character))
data_USA_02b <- data_USA_02b %>%
select(Progress:`Duration (in seconds)`,ResponseId,consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data <- bind_rows(data_main, data_USA_02b)
data <- data %>%
mutate(across(everything(), as.numeric)) %>% select(Progress:`Duration (in seconds)`,ResponseId,consent:grat_god_letter, me_attention, meals_attention, attention_check:feedback, lab)
data_USA_02b <- data_USA_02b %>%
mutate(across(everything(), as.numeric))
data_USA_02b <- data_USA_02b %>%
select(Progress:`Duration (in seconds)`,ResponseId,consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data_USA_02c <- data_USA_02c %>%
mutate(across(everything(), as.numeric)) %>%  select(Progress:Duration..in.seconds., ResponseId, consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data <- bind_rows(data_main, data_USA_02b)
# Fetch the main survey data
#This is not working for some reason
data_main <- read.csv(file = here("data", "GlobalGratitude_LabSpecificData.csv"), fileEncoding = "UTF-8")
data <- read_csv("C:/Users/avd002/Dropbox/PC/Documents/GitHub/GlobalGratitudeProject/data/GlobalGratitude_LabSpecificData.csv")
data <- data %>%
mutate(across(everything(), as.character)) %>%
select(Progress:`Duration (in seconds)`, ResponseId, consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data_USA_02b <- read.csv(file = here("data", "USA_02b_raw_harmonized.csv"))
data_USA_02b <- data_USA_02b %>%
rename("Duration (in seconds)" = `Duration..in.seconds.`)%>% rename("control_events" = `control_list`)
data_USA_02b <- data_USA_02b %>%
mutate(across(everything(), as.character))
data_USA_02b <- data_USA_02b %>%
select(Progress:`Duration (in seconds)`,ResponseId,consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data_USA_02c <- read.csv(file = here("data", "USA_02c.csv"))
data_USA_02c <- data_USA_02c %>%
mutate(across(everything(), as.character)) %>%  select(Progress:Duration..in.seconds., ResponseId, consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data <- bind_rows(data_main, data_USA_02b)
data <- bind_rows(data, data_USA_02b)
data <- bind_rows(data, data_USA_02c)
data_main <- read_csv("C:/Users/avd002/Dropbox/PC/Documents/GitHub/GlobalGratitudeProject/data/GlobalGratitude_LabSpecificData.csv")
data_main <- data_main %>%
mutate(across(everything(), as.character)) %>%
select(Progress:`Duration (in seconds)`, ResponseId, consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
data <- bind_rows(data_main, data_USA_02b)
data <- bind_rows(data, data_USA_02c)
data <- data[-1, , drop = FALSE]
data <- bind_rows(data_main, data_USA_02b)
data <- bind_rows(data, data_USA_02c)
View(data)
View(data)
data <- data[-1, , drop = FALSE]
#Clean data
data$Progress <- as.numeric(data$Progress)
data <- data %>%
#Removed test links and incomplete surveys
filter(DistributionChannel != "preview",
consent == 1,
Progress >= 95,
lab != "")
data_main <- read_csv("C:/Users/avd002/Dropbox/PC/Documents/GitHub/GlobalGratitudeProject/data/GlobalGratitude_LabSpecificData.csv")
data_main <- data_main %>%
mutate(across(everything(), as.character))
data_USA_02b <- read.csv(file = here("data", "USA_02b_raw_harmonized.csv"))
data_USA_02b <- data_USA_02b %>%
rename("Duration (in seconds)" = `Duration..in.seconds.`)%>% rename("control_events" = `control_list`)
data_USA_02b <- data_USA_02b %>%
mutate(across(everything(), as.character))
data_USA_02c <- read.csv(file = here("data", "USA_02c.csv"))
data_USA_02c <- data_USA_02c %>%
mutate(across(everything(), as.character))
data <- bind_rows(data_main, data_USA_02b)
data <- bind_rows(data, data_USA_02c)
data <- data[-1, , drop = FALSE]
data$Progress <- as.numeric(data$Progress)
data <- data %>%
#Removed test links and incomplete surveys
filter(DistributionChannel != "preview",
consent == 1,
Progress >= 95,
lab != "")
data <- data %>%
# 4/22/2024 TUR_01 used real link for testing purposes
filter(ResponseId != "R_42KUGZSS76NgWH7",
ResponseId != "R_4W4EXfgeyk1rCYF",
ResponseId != "R_45Z862EIfzYcin4",
ResponseId != "R_7BhJx9Ci7THupmF",
ResponseId != "R_42Lv9fg5qi9V9xm",
ResponseId != "R_2kFa26mh78uevnz",
ResponseId != "R_4DRThnH8LgbEvM8",
ResponseId != "R_4r1kAEqQCo1PNn6",
ResponseId != "R_4GQErqyYDlRWVwZ",
ResponseId != "R_4SGF0GCHSHIN0ls",
ResponseId != "R_6Pndj5c7sr1pcU3",
ResponseId != "R_8lQxsY2ITg7HKh1",
ResponseId != "R_8HXsI5PQftiJUYk",
ResponseId != "R_8iVWI3CN49ACiUp",
#6/6/2024 Removed USA_01 duplicate data
ResponseId != "R_6rDfD5u84z6WufT",
#11/21/2024 Removed DZA_01 test data
ResponseId != "R_4ioYJK1zR2FgR4R",
ResponseId != "R_4OvlyOmeTsmLpFn",
ResponseId != "R_4BA1gbglSYnVyDK")
# Change the 'incentive' column from "volunteer" to "paid" for NOR_01 participants after 11/19/2024
data <- data %>%
mutate(incentive = if_else(lab == "NOR_01" & StartDate > as.POSIXct("2024-11-19 00:00:00"),
"paid", incentive))
#Edit dataset to only include certain columns
lab_specific_data <- data %>% select(Progress:Duration..in.seconds., ResponseId, consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
condition <- data %>% select(ResponseId, condition, control_events, lab)
data$Progress <- as.numeric(data$Progress)
data$consent <- as.numeric(data$consent)
data <- data %>%
#Removed test links and incomplete surveys
filter(DistributionChannel != "preview",
consent == 1,
Progress >= 95,
lab != "")
View(data)
unique(data$Progress)
unique(data$consent)
unique(data$lab)
data <- data %>%
# 4/22/2024 TUR_01 used real link for testing purposes
filter(ResponseId != "R_42KUGZSS76NgWH7",
ResponseId != "R_4W4EXfgeyk1rCYF",
ResponseId != "R_45Z862EIfzYcin4",
ResponseId != "R_7BhJx9Ci7THupmF",
ResponseId != "R_42Lv9fg5qi9V9xm",
ResponseId != "R_2kFa26mh78uevnz",
ResponseId != "R_4DRThnH8LgbEvM8",
ResponseId != "R_4r1kAEqQCo1PNn6",
ResponseId != "R_4GQErqyYDlRWVwZ",
ResponseId != "R_4SGF0GCHSHIN0ls",
ResponseId != "R_6Pndj5c7sr1pcU3",
ResponseId != "R_8lQxsY2ITg7HKh1",
ResponseId != "R_8HXsI5PQftiJUYk",
ResponseId != "R_8iVWI3CN49ACiUp",
#6/6/2024 Removed USA_01 duplicate data
ResponseId != "R_6rDfD5u84z6WufT",
#11/21/2024 Removed DZA_01 test data
ResponseId != "R_4ioYJK1zR2FgR4R",
ResponseId != "R_4OvlyOmeTsmLpFn",
ResponseId != "R_4BA1gbglSYnVyDK")
data <- bind_rows(data_main, data_USA_02b)
data <- bind_rows(data, data_USA_02c)
data <- data[-1, , drop = FALSE]
data$Progress <- as.numeric(data$Progress)
data$consent <- as.numeric(data$consent)
data <- data %>%
#Removed test links and incomplete surveys
filter(DistributionChannel != "preview",
consent == 1,
Progress >= 95,
lab != "")
unique(data$DistributionChannel)
data <- data %>%
# 4/22/2024 TUR_01 used real link for testing purposes
filter(ResponseId != "R_42KUGZSS76NgWH7",
ResponseId != "R_4W4EXfgeyk1rCYF",
ResponseId != "R_45Z862EIfzYcin4",
ResponseId != "R_7BhJx9Ci7THupmF",
ResponseId != "R_42Lv9fg5qi9V9xm",
ResponseId != "R_2kFa26mh78uevnz",
ResponseId != "R_4DRThnH8LgbEvM8",
ResponseId != "R_4r1kAEqQCo1PNn6",
ResponseId != "R_4GQErqyYDlRWVwZ",
ResponseId != "R_4SGF0GCHSHIN0ls",
ResponseId != "R_6Pndj5c7sr1pcU3",
ResponseId != "R_8lQxsY2ITg7HKh1",
ResponseId != "R_8HXsI5PQftiJUYk",
ResponseId != "R_8iVWI3CN49ACiUp",
#6/6/2024 Removed USA_01 duplicate data
ResponseId != "R_6rDfD5u84z6WufT",
#11/21/2024 Removed DZA_01 test data
ResponseId != "R_4ioYJK1zR2FgR4R",
ResponseId != "R_4OvlyOmeTsmLpFn",
ResponseId != "R_4BA1gbglSYnVyDK")
#Edit dataset to only include certain columns
lab_specific_data <- data %>% select(Progress:Duration..in.seconds., ResponseId, consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
condition <- data %>% select(ResponseId, condition, control_events, lab)
# Split data by lab
lab_data <- split(condition, condition$lab)
# Create a new workbook
wb <- createWorkbook()
# Loop through each lab and write the data to separate sheets
for (lab in names(lab_data)) {
# Add a sheet for each lab
addWorksheet(wb, lab)
# Write the data for the current lab into the sheet
writeData(wb, sheet = lab, lab_data[[lab]])
}
# Save the workbook to an Excel file
saveWorkbook(wb, "lab_specific_data.xlsx", overwrite = TRUE)
# Split data by lab
lab_data <- split(condition, condition$lab)
# Create a new workbook
wb <- createWorkbook()
# Loop through each lab and write the data to separate sheets
for (lab in names(lab_data)) {
# Add a sheet for each lab
addWorksheet(wb, lab)
# Write the data for the current lab into the sheet
writeData(wb, sheet = lab, lab_data[[lab]])
}
# Save the workbook to an Excel file
saveWorkbook(wb, "lab_specific_data.xlsx", overwrite = TRUE)
data <- data %>% select(Progress:Duration..in.seconds., ResponseId, consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
# Split data by lab
lab_data <- split(condition, condition$lab)
# Create a new workbook
wb <- createWorkbook()
# Loop through each lab and write the data to separate sheets
for (lab in names(lab_data)) {
# Add a sheet for each lab
addWorksheet(wb, lab)
# Write the data for the current lab into the sheet
writeData(wb, sheet = lab, lab_data[[lab]])
}
# Save the workbook to an Excel file
saveWorkbook(wb, "lab_specific_data.xlsx", overwrite = TRUE)
data <- data %>% select(Progress:Duration..in.seconds., ResponseId, consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
# Split data by lab
lab_data <- split(condition, condition$lab)
# Create a new workbook
wb <- createWorkbook()
# Loop through each lab and write the data to separate sheets
for (lab in names(lab_data)) {
# Add a sheet for each lab
addWorksheet(wb, lab)
# Write the data for the current lab into the sheet
writeData(wb, sheet = lab, lab_data[[lab]])
}
# Save the workbook to an Excel file
saveWorkbook(wb, "lab_specific_data.xlsx", overwrite = TRUE)
View(data)
View(data)
data <- data %>% select(Progress:Duration..in.seconds., ResponseId, consent:grat_god_letter, meals_attention, attention_check:feedback, lab)
View(data)
lab_specific_data <- data %>%
select(Progress:`Duration..in.seconds.`, ResponseId, consent:grat_god_letter, meals_attention, attention_check:feedback, lab, condition)
View(data)
View(lab_specific_data)
condition <- data %>% select(ResponseId, condition, control_events, lab)
View(condition)
View(data)
lab_specific_data <- data %>% select(Progress,`Duration (in seconds)`, ResponseId, consent:condition, control_events:grat_god_letter, meals_attention, attention_check:feedback, lab)
View(lab_specific_data)
colnames(data)
lab_specific_data <- data %>% select(Progress,`Duration (in seconds)`, ResponseId, consent,condition, control_events:grat_god_letter, meals_attention, attention_check:feedback, lab)
View(lab_specific_data)
# Split data by lab
lab_data <- split(lab_specific_data, lab_specific_data$lab)
# Create a new workbook
wb <- createWorkbook()
# Loop through each lab and write the data to separate sheets
for (lab in names(lab_data)) {
# Add a sheet for each lab
addWorksheet(wb, lab)
# Write the data for the current lab into the sheet
writeData(wb, sheet = lab, lab_data[[lab]])
}
# Save the workbook to an Excel file
saveWorkbook(wb, "lab_specific_data.xlsx", overwrite = TRUE)
View(lab_data)
unique(lab)
unique(lab_specific_data$lab)
lab_data <- split(lab_specific_data, lab_specific_data$lab)
lab_data
View(lab_data)
data_USA_02c <- read.csv(file = here("data", "USA_02c.csv"))
data_USA_02c <- data_USA_02c %>%
mutate(across(obligated:ls_5, as.numeric)) %>%
mutate(across(c(id, lambda2), as.character)) %>%
select(StartDate:gov_leaders_6, meals_attention:pageNo)
data_USA_02c
lab_specific_data <- data_USA_02c %>% select(Progress,`Duration (in seconds)`, ResponseId, consent,condition, control_events:grat_god_letter, meals_attention, attention_check:feedback, lab)
lab_specific_data <- data_USA_02c %>% select(Progress,Duration..in.seconds., ResponseId, consent,condition, control_events:grat_god_letter, meals_attention, attention_check:feedback, lab)
data_main <- read.csv(file = here("data", "GlobalGratitude_Final.csv"))
data_main <- data_main %>%
mutate(across(obligated:ls_5, as.numeric)) %>%
select(StartDate:gov_leaders_6, meals_attention:pageNo)
# Fetch the USA_02b (harmonized) survey data
data_USA_02b <- read.csv(file = here("data", "USA_02b_raw_harmonized.csv"))
data_USA_02b <- data_USA_02b %>%
rename("control_events" = `control_list`)
data_USA_02b <- data_USA_02b %>%
mutate(across(obligated:ls_5, as.numeric)) %>%
select(StartDate:pageNo)
# Read and combine the CSV files
data <- bind_rows(data_main, data_USA_02b)
# Fetch the USA_02c survey data
data_USA_02c <- read.csv(file = here("data", "USA_02c.csv"))
data_USA_02c <- data_USA_02c %>%
mutate(across(obligated:ls_5, as.numeric)) %>%
mutate(across(c(id, lambda2), as.character)) %>%
select(StartDate:gov_leaders_6, meals_attention:pageNo)
# Read and combine the CSV files
data <- bind_rows(data_main, data_USA_02c)
#Clean data
data <- data %>%
#Removed test links and incomplete surveys
filter(DistributionChannel != "preview",
consent == 1,
Progress >= 95,
lab != "")
# fix known issues
data <- data %>%
# 4/22/2024 TUR_01 used real link for testing purposes
filter(ResponseId != "R_42KUGZSS76NgWH7",
ResponseId != "R_4W4EXfgeyk1rCYF",
ResponseId != "R_45Z862EIfzYcin4",
ResponseId != "R_7BhJx9Ci7THupmF",
ResponseId != "R_42Lv9fg5qi9V9xm",
ResponseId != "R_2kFa26mh78uevnz",
ResponseId != "R_4DRThnH8LgbEvM8",
ResponseId != "R_4r1kAEqQCo1PNn6",
ResponseId != "R_4GQErqyYDlRWVwZ",
ResponseId != "R_4SGF0GCHSHIN0ls",
ResponseId != "R_6Pndj5c7sr1pcU3",
ResponseId != "R_8lQxsY2ITg7HKh1",
ResponseId != "R_8HXsI5PQftiJUYk",
ResponseId != "R_8iVWI3CN49ACiUp",
#6/6/2024 Removed USA_01 duplicate data
ResponseId != "R_6rDfD5u84z6WufT",
#11/21/2024 Removed DZA_01 test data
ResponseId != "R_4ioYJK1zR2FgR4R",
ResponseId != "R_4OvlyOmeTsmLpFn",
ResponseId != "R_4BA1gbglSYnVyDK")
# Change the 'incentive' column from "volunteer" to "paid" for NOR_01 participants after 11/19/2024
data <- data %>%
mutate(incentive = if_else(lab == "NOR_01" & StartDate > "11/19/2024 0:00",
"paid", incentive))
lab_specific_data <- data %>% lab == "USA_02c"
lab_specific_data <- data %>% filter(lab == "USA_02c")
write.csv(data,
file = here('lab_specific_data',
"lab_specific_data.csv")
)
library(here)
# specify directory
i_am("code/GlobalGratitude_Final_Complete_Harmonize.R")
write.csv(data,
file = here('lab_specific_data',
"lab_specific_data.csv")
)
write.csv(lab_specific_data,
file = here('data',
"lab_specific_data.csv")
)
lab_specific_data <- data %>% filter(lab == "USA_02c")
lab_specific_data <- data %>% filter(lab == "USA_02c")
%>% select(Progress,`Duration (in seconds)`, ResponseId, consent,condition, control_events:grat_god_letter, meals_attention, attention_check:feedback, lab)
lab_specific_data <- data %>%
filter(lab == "USA_02c") %>%
select(Progress, `Duration (in seconds)`, ResponseId, consent, condition, control_events:grat_god_letter, meals_attention, attention_check:feedback, lab)
lab_specific_data <- data %>%
filter(lab == "USA_02c") %>%
select(Progress, Duration..in.seconds., ResponseId, consent, condition, control_events:grat_god_letter, meals_attention, attention_check:feedback, lab)
write.csv(lab_specific_data,
file = here('data',
"lab_specific_data.csv")
)
